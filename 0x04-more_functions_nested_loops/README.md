mooooore functions and nested loops
